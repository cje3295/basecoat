syntax = "proto3";

package api;

message Formula {
  string id = 1;     // Unique id for formula
  string name = 2;   // Formula color name
  string number = 3; // Used to identify formulas in other systems
  string notes = 4;
  int64 created = 5;        // Time created in epoch
  int64 modified = 6;       // Time modified in epoch
  repeated string jobs = 7; // List of jobs ids that this formula was used for
  repeated Base bases = 8;
  repeated Colorant colorants = 9;
}

// Colorants are the different colors included in a base so that a color
// can be created
message Colorant {
  string type = 1; // Which manufacturer the colorant was made by
  string name = 2;
  string amount = 3;
}

message Base {
  string type = 1;
  string name = 2;
  string amount = 3;
}

// Jobs are places where a formula might have been sent
message Job {
  string id = 1;
  string name = 2;
  string street = 3;
  string street2 = 4;
  string city = 5;
  string state = 6;
  string zipcode = 7;
  string notes = 8;
  int64 created = 9;
  int64 modified = 10;
  repeated string formulas = 11; // formula ids that have been made for this job
  Contact contact = 12;
}

// Contact is information about point of contact for a job
message Contact {
  string name = 1;
  string info = 2;
}

message User {
  string name = 1;
  string hash = 2;
}

service Basecoat {
  rpc CreateAPIToken(CreateAPITokenRequest) returns (CreateAPITokenResponse) {}
  rpc GetFormula(GetFormulaRequest) returns (GetFormulaResponse) {}
  rpc ListFormulas(ListFormulasRequest) returns (ListFormulasResponse) {}
  rpc CreateFormula(CreateFormulaRequest) returns (CreateFormulaResponse) {}
  rpc UpdateFormula(UpdateFormulaRequest) returns (UpdateFormulaResponse) {}
  rpc DeleteFormula(DeleteFormulaRequest) returns (DeleteFormulaResponse) {}
  rpc GetJob(GetJobRequest) returns (GetJobResponse) {}
  rpc ListJobs(ListJobsRequest) returns (ListJobsResponse) {}
  rpc CreateJob(CreateJobRequest) returns (CreateJobResponse) {}
  rpc UpdateJob(UpdateJobRequest) returns (UpdateJobResponse) {}
  rpc DeleteJob(DeleteJobRequest) returns (DeleteJobResponse) {}
}

message CreateAPITokenRequest {
  string user = 1;
  string password = 2;
  int64 duration = 3; // duration of API key in seconds
}

message CreateAPITokenResponse { string key = 1; }

message GetFormulaRequest { string id = 1; }
message GetFormulaResponse { Formula formula = 1; }

message ListFormulasRequest {}
message ListFormulasResponse { map<string, Formula> formulas = 1; }

message CreateFormulaRequest {
  string name = 1;
  string number = 2;
  string notes = 3;
  repeated string jobs = 4;
  repeated Base bases = 5;
  repeated Colorant colorants = 6;
}
message CreateFormulaResponse { string id = 1; }

message UpdateFormulaRequest {
  string id = 1;
  string name = 2;
  string number = 3;
  string notes = 4;
  repeated string jobs = 5;
  repeated Base bases = 6;
  repeated Colorant colorants = 7;
}
message UpdateFormulaResponse {}

message DeleteFormulaRequest { string id = 1; }
message DeleteFormulaResponse {}

message GetJobRequest { string id = 1; }
message GetJobResponse { Job job = 1; }

message ListJobsRequest {}
message ListJobsResponse { map<string, Job> jobs = 1; }

message CreateJobRequest {
  string name = 1;
  string street = 2;
  string street2 = 3;
  string city = 4;
  string state = 5;
  string zipcode = 6;
  string notes = 7;
  repeated string formulas = 8; // formula ids that have been made for this job
  Contact contact = 9;
}
message CreateJobResponse { string id = 1; }

message UpdateJobRequest {
  string id = 1;
  string name = 2;
  string street = 3;
  string street2 = 4;
  string city = 5;
  string state = 6;
  string zipcode = 7;
  string notes = 8;
  repeated string formulas = 9; // ids of formulas
  Contact contact = 10;
}
message UpdateJobResponse {}

message DeleteJobRequest { string id = 1; }
message DeleteJobResponse {}
